<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Cat√°logo Multi√ëe√±o : Servicios T√©cnicos y mucho m√°s</title>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WCLN0THXSJ"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-WCLN0THXSJ');
    </script>

    <!-- META TAGS CR√çTICOS PARA OCULTAR URL BAR -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Cat√°logo Port√°til Peter Snoopy">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#2c3e50">
    <meta name="msapplication-TileColor" content="#2c3e50">
    <meta name="msapplication-navbutton-color" content="#2c3e50">
    <meta name="application-name" content="Peter Snoopy">
    <meta name="format-detection" content="telephone=no">

    <!-- PREVENIR ZOOM NO DESEADO -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

    <link rel="stylesheet" href="css/style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="./images/icon-192.png">

    <!-- APPLE SPECIFIC -->
    <link rel="apple-touch-icon" href="./images/icon-192.png">
    <link rel="apple-touch-startup-image" href="./images/splash-screen.png">

    <meta name="theme-color" content="#2c3e50">
</head>
<body>
    <div id="quickLoader" class="quick-loader">
        <div class="loader-text">Cargando cat√°logo...</div>
    </div>
    <div class="container">
        <header>
            <div class="header-top">
                <div class="logo-header">
                    <img src="./images/icon-512.png" alt="Logo Peter Snoopy" class="logo">
                    <div class="company-info">
                        <h1>Peter Snoopy</h1>
                        <p>Ventas "DE TODO UN POCO"</p>
                    </div>
                    <!-- ‚úÖ NUEVA IMAGEN AGREGADA -->
                    <img src="./images/icon-512-2.png" alt="Logo adicional Peter Snoopy" class="logo-secondary">
                </div>
                <div class="contact-info">
                    <a href="tel:+584126597297" class="contact-btn phone-btn">
                        üìû Llamar
                    </a>
                    <a href="https://wa.me/584126597297?text=Hola,%20me%20interesan%20sus%20productos" 
                    target="_blank" class="contact-btn whatsapp-btn">
                        üí¨ WhatsApp
                    </a>
                </div>
            </div>
            <div class="search-filters">
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="Buscar art√≠culos...">
                    <button id="searchBtn">üîç</button>
                </div>
                <div class="filter-category">
                    <select id="categoryFilter">
                        <option value="all">Todas las categor√≠as</option>
                    </select>
                </div>
            </div>
        </header>

        <main>
            <div class="products-grid" id="productsGrid">
                <!-- Productos cargados din√°micamente -->
            </div>
        </main>

        <footer>
            <div class="footer-contact">
                <h3>Contacto</h3>
                <div class="contact-options">
                    <a href="tel:+584126597297" class="footer-contact-link">
                        üìû +58 412-6597297
                    </a>
                    <a href="https://wa.me/584126597297?text=Hola,%20me%20interesan%20sus%20productos" 
                       target="_blank" class="footer-contact-link">
                        üí¨ WhatsApp
                    </a>
                    <a href="mailto:ramonsimancas61@gmail.com" class="footer-contact-link">
                        ‚úâÔ∏è ramonsimancas61@gmail.com
                    </a>
                </div>
            </div>
            <div class="footer-copyright">
                <p>&copy; 2025 
                    <a href="https://wa.me/584126097052?text=Me%20gustar√≠a%20conocer%20su%20oferta%20para%20que%20publique%20mis%20art√≠culos,%20productos%20o%20servicios." 
                       target="_blank" class="provider-link">Intelligere</a>. 
                    Todos los derechos reservados.
                </p>
            </div>
        </footer>

        <!-- Modal de detalles -->
        <div id="productModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <div id="modalContent"></div>
                <div class="modal-actions">
                    <!-- Fila 1 -->
                    <div class="contact-row">
                        <a href="tel:+584126597297" class="contact-btn phone-btn" id="btnLlamada">
                            <span class="contact-icon">üìû</span>
                            <span class="contact-text">Llamar</span>
                        </a>
                        <a href="#" target="_blank" class="contact-btn whatsapp-btn" id="whatsappModal">
                            <span class="contact-icon">üí¨</span>
                            <span class="contact-text">WhatsApp</span>
                        </a>
                    </div>
                    <!-- Fila 2 -->
                    <div class="contact-row">
                        <a href="#" class="contact-btn sms-btn" id="btnSMS">
                            <span class="contact-icon">üì±</span>
                            <span class="contact-text">SMS</span>
                        </a>
                        <a href="#" class="contact-btn email-btn" id="btnCorreo">
                            <span class="contact-icon">‚úâÔ∏è</span>
                            <span class="contact-text">Correo</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="./js/version-manager.js"></script>
    <script src="./js/local-config.js"></script>
    <script src="./js/notifications-helper.js"></script>
    <script src="./js/app.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./sw.js?v=' + (new Date().getTime()))
                .then(function(registration) {
                    console.log('‚úÖ Service Worker registrado:', registration.scope);
                    
                    // Escuchar mensajes del Service Worker
                    navigator.serviceWorker.addEventListener('message', event => {
                        if (event.data.type === 'VERSION_UPDATED') {
                            console.log('üîÑ Versi√≥n actualizada recibida:', event.data.version);
                            mostrarNotificacion(`Versi√≥n ${event.data.version} instalada`, 'success');
                        }
                    });
                    
                    // Iniciar verificador de versiones
                    if (window.versionManager) {
                        window.versionManager.startPeriodicCheck();
                        
                        // Escuchar actualizaciones
                        window.versionManager.onUpdate((newVersion, oldVersion) => {
                            console.log(`üÜï Actualizaci√≥n: ${oldVersion} ‚Üí ${newVersion}`);
                            // Opcional: Forzar recarga de productos
                            if (window.cargarProductosConPrecargaPersistente) {
                                window.cargarProductosConPrecargaPersistente(true);
                            }
                        });
                    }
                })
                .catch(function(error) {
                    console.log('‚ùå Error registrando Service Worker:', error);
                });
            });
        }
    </script>
    <!-- SCRIPT PARA OCULTAR URL BAR EN ANDROID -->
    <script>
        // Prevenir que aparezca la URL bar en Android
        if ('standalone' in navigator || window.matchMedia('(display-mode: standalone)').matches) {
            // La app est√° en modo standalone (PWA instalada)
            document.documentElement.style.setProperty('--sat', 'env(safe-area-inset-top)');
        }    
        // Prevenir zoom con doble tap (mantener esto)
        document.addEventListener('touchstart', function(event) {
            if (event.touches.length > 1) {
                event.preventDefault();
            }
        }, { passive: false });
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, { passive: false });
    </script>
</body>
</html>